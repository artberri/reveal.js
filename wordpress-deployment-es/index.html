<!doctype html>
<html lang="en">

    <head>
        <meta charset="utf-8">

        <title>Desplegando WordPress como un profesional</title>

        <meta name="description" content="A framework for easily creating beautiful presentations using HTML">
        <meta name="author" content="Hakim El Hattab">

        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">


        <link href='https://fonts.googleapis.com/css?family=Oswald:400,700|Libre+Baskerville' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="../dist/reveal.css">
        <link rel="stylesheet" href="../dist/theme/black.css" id="theme">

        <!-- Theme used for syntax highlighting of code -->
        <link rel="stylesheet" href="../plugin/highlight/zenburn.css">
        <link rel="stylesheet" href="style.css">

    </head>

    <body>

        <div class="reveal">

            <!-- Any section element inside of this container is displayed as a slide -->
            <div class="slides">
                <section id="home" data-background="images/home.jpg">
                    <h1><span id="deploying">Desplegando</span> <br><span class="wordpress"><span class="word">Word</span><span class="press">Press</span></span> <br><span id="likeapro">como&nbsp;un&nbsp;profesional</span></h1>
                    <p id="byauthor">
                        Por <a href="http://www.berriart.com/">Alberto Varela</a>
                    </p>
                </section>

                <section>
                    <h2 class="mini">Quién habla?</h2>
                    <div class=" fragment">
                        <img style="border:0;box-shadow:none;margin:0;width:600px;" data-src="images/travioor.jpg" alt="Travioor" >
                        <p>Soy <a href="http://www.berriart.com">Alberto Varela</a> y trabajo en <a href="http://www.travioor.com">Travioor</a></p>
                        <p class=" fragment"><small style="color:#666;"><a style="color:#666;" href="http://www.berriart.com">www.berriart.com</a> | alberto@berriart.com | <a style="color:#666;" href="http://twitter.com/artberri">@artberri</a></small>
                        </p>
                    </div>
                </section>

                <section data-transition="fade-in">
                    <h2 class="mini">Webs <span>VS</span> Webs profesionales</h2>
                    <br>
                    <div class="fragment">
                        <img width="440" data-src="images/suzanne.png" alt="Done stamp" >
                    </div>
                </section>

                <section data-transition-speed="fast" data-transition="fade-in ">
                    <h2 class="mini">Webs <span>VS</span> Webs profesionales</h2>
                    <br>
                    <div>
                        <img width="440" data-src="images/10up.png" alt="Done stamp" >
                    </div>
                </section>

                <section  data-transition="fade-in ">
                    <h2 class="mini">Despliegues <span>VS</span> Despliegues profesionales</h2>
                    <br>
                    <div  class=" fragment">
                        <img width="440" data-src="images/minion2.gif" alt="Done stamp" >
                    </div>
                </section>

                <section data-transition-speed="fast" data-transition="fade-in">
                    <h2 class="mini">Despliegues <span>VS</span> Despliegues profesionales</h2>
                    <br>
                    <div >
                        <img width="440" data-src="images/minion3.gif">
                    </div>
                </section>

                <section>
                    <h2>Cómo?</h2>
                </section>

                <section>
                    <section>
                        <h2>El 'Dogma'</h2>
                        <h3>Los desarrolladores son los únicos responsables del código</h3>
                    </section>
                    <section>
                        <h2 class="mini">Gente que no debería poner código en producción:</h2>
                        <ul>
                            <li class="fragment">El cliente</li>
                            <li class="fragment">El departamento de márketing</li>
                            <li class="fragment">"El jefe"</li>
                            <li class="fragment">Matt Mullenweg</li>
                        </ul>
                    </section>
                    <section>
                        <h2 class="mini">wp-config.php</h2>
                        <p>Deshabilita cualquier modificación de código desde el administrador.</p>
                        <pre><code class="hljs" data-trim contenteditable>
&lt;?php

// Disable the Plugin and Theme Editor
define( 'DISALLOW_FILE_EDIT', true );
// Disable Plugin and Theme Update and Installation
define( 'DISALLOW_FILE_MODS', true );
// Disable All Automatic Updates
define( 'AUTOMATIC_UPDATER_DISABLED', true );

                        </code></pre>
                        <p><small>Más información sobre constantes: <a href="https://codex.wordpress.org/Editing_wp-config.php">Wordpress Codex</a>.</small></p>
                    </section>
                    <section>
                        <h2 class="mini">Version Control System</h2>
                        <h3>Git</h3>
                        <p>Self hosted, Github, Bitbucket, Gitlab, VSO...</p>
                        <h3>Subversion</h3>
                        <p>No Pull Requests :(</p>
                    </section>
                    <section>
                        <h2 class="mini">Gestionando dependencias</h2>
                        <h3><a href="https://getcomposer.org/">Composer</a> + <a href="https://wpackagist.org/">WPackagist</a></h3>
                        <pre><code class="hljs" data-trim contenteditable>
# composer.json
{
    "name": "mycompany/brilliant-wordpress-site",
    "repositories":[
        {
            "type": "composer",
            "url": "https://wpackagist.org"
        }
    ],
    "require": {
        "php": ">=5.4",
        "johnpbloch/wordpress": "^4.5",
        "wpackagist-plugin/wordpress-seo": "^3.2",
        "wpackagist-plugin/mailchimp-for-wp": "^3.1",
        "wpackagist-theme/yourparenttheme": "^1.3",
    }
}
                        </code></pre>
                        <p><small><a href="https://wp-cli.org/">WP-CLI</a> puede ser otra opción para gestionar dependencias.</small></p>
                    </section>
                    <section>
                        <h2 class="mini">Tu código: Themes &amp; Plugins</h2>
                        <ul>
                            <li>Todo tu código debería estar organizado en Themes &amp; Plugins, y es el único código que debería estar en control de versiones.</li>
                            <li>No modifiques ninguna dependencia. Ni plugins, ni themes. Usa <strong>hooks</strong>, <strong>actions</strong> y <strong>child themes</strong> para sobrescribirlos.</li>
                        </ul>
                    </section>
                    <section>
                        <h2 class="mini">Branching y pull requests</h2>
                        <ul>
                            <li><a href="https://www.atlassian.com/git/tutorials/comparing-workflows">Git workflows</a>: Centralizado, Feature Branch, Gitflow, Forking Workflow...</li>
                            <li>Haz revisiones de código con pull requests. <a href="http://tech.veinteractive.com/the-code-review-process.html">Aquí</a> puedes ver unos consejos para mejorar tu proceso de revisión de código.</li>
                        </ul>
                    </section>
                    <section data-background="images/minions5.jpg">
                        <h1>Vamos<br> a hacer <br>una Pull<br> Request!</h1>
                    </section>

                </section>

                <section>
                    <section>
                        <h2>La 'Regla'</h2>
                        <h3>El despliegue debe estar totalmente automatizado</h3>
                    </section>
                    <section>
                        <h2 class="mini">No más "Works on my machine"</h2>
                        <ul>
                            <li class="fragment">Tu definición de "hecho" debe estar clara.</li>
                            <li class="fragment">Replica tu entorno de producción en desarrollo: <a href="https://www.vagrantup.com/">Vagrant</a>, <a href="https://www.docker.com/">Docker</a>, <a href="https://puppet.com/">Puppet</a>, <a href="https://www.chef.io/">Chef</a>,...</li>
                            <li class="fragment">Crea entornos de integración y pruebas</li>
                        </ul>
                    </section>
                    <section>
                        <h2 class="mini">Herramientas de despliegue y Task Runners</h2>
                        <ul>
                            <li>PHP: <a href="http://deployer.org/">Deployer</a>, <a href="http://magephp.com/">Magallanes</a>, <a href="https://www.phing.info/">Phing</a>, ...</li>
                            <li>Otros: <a href="http://gruntjs.com/">Grunt</a>, <a href="http://gulpjs.com/">Gulp</a>, <a href="http://ant.apache.org/">Ant</a>, ...</li>
                        </ul>
                    </section>
                    <section>
                        <h2 class="mini">Ejemplo con Deployer</h2>

                        <p>Instalar con <em>composer</em>:</p>

                        <pre><code class="hljs" data-trim contenteditable>
composer require --dev deployer/deployer
composer require --dev deployphp/recipes
                        </code></pre>

                        <p>Tu <em>composer.json</em> incluirá ahora la referencia a las dependencias:</p>

                        <pre><code class="hljs" data-trim contenteditable>
# composer.json
# ...
    "require-dev": {
        "deployer/deployer": "^3.2",
        "deployphp/recipes": "^3.1",
    },
# ...
                        </code></pre>
                    </section>
                    <section>
                        <h2 class="mini">Ejemplo con Deployer</h2>

                        <p>Configurar los pasos de despliegue en el fichero <em>deploy.php</em>:</p>

                        <pre><code class="hljs" data-trim contenteditable>
&lt;?php
// deploy.php
require 'recipe/common.php';
require 'vendor/deployphp/recipes/recipes/configure.php';
require 'vendor/deployphp/recipes/recipes/rsync.php';

set('shared_dirs', [
    'wp-content/uploads',
    'wp-content/cache',
]);
set('shared_files', [
    'wp-config.php',
]);
set('writable_use_sudo', false);
set('http_user', 'deploy');
env('rsync_src', __DIR__ . '/src');
set('rsync', [
    'exclude' => [
        'wp-content/upgrade',
        'wp-content/cache',
        'wp-config.php',
        'wp-content/uploads',
    ],
]);
set('keep_releases', 5);

task('deploy', [
  'deploy:prepare',
  'deploy:release',
  'deploy:configure',
  'rsync',
  'deploy:shared',
  'deploy:symlink',
  'cleanup',
])->desc('Deploy project');
after('deploy', 'success');

serverList(__DIR__ . '/servers.yml');
                        </code></pre>
                    </section>
                    <section>
                        <h2 class="mini">Ejemplo con Deployer</h2>

                        <p>Configurar las credenciales y los servidores en el fichero <em>servers.yml</em>:</p>

                        <pre><code class="hljs" data-trim contenteditable>
# servers.yml
staging:
  host: staging.sinrumbofijo.com
  user: deploy
  identity_file:
    public_key:  deploy_rsa.pub
    private_key: deploy_rsa
    password:    ''
  stage: staging
  deploy_path: /home/www/staging.sinrumbofijo.com
  app:
    url: http://staging.sinrumbofijo.com
    root: /home/www/staging.sinrumbofijo.com/current
    db:
      name: 'staging_database_name'
      user: 'staging_database_user'
      pass: 'staging_database_pass'
      host: 'staging_database_host'
    secret:
      auth_key: 'write a better secret here'
      secure_auth_key: 'write a better secret here'
      logged_in_key: 'write a better secret here'
      nonce_key: 'write a better secret here'
      auth_salt: 'write a better secret here'
      secure_auth_salt: 'write a better secret here'
      logged_in_salt: 'write a better secret here'
      nonce_salt: 'write a better secret here'

production:
  host: www.sinrumbofijo.com
  user: deploy
  identity_file:
    public_key:  deploy_rsa.pub
    private_key: deploy_rsa
    password:    ''
  stage: staging
  deploy_path: /home/www/www.sinrumbofijo.com
  app:
    url: http://www.sinrumbofijo.com
    root: /home/www/www.sinrumbofijo.com/current
    db:
      name: 'production_database_name'
      user: 'production_database_user'
      pass: 'production_database_pass'
      host: 'production_database_host'
    secret:
      auth_key: 'write a better secret here'
      secure_auth_key: 'write a better secret here'
      logged_in_key: 'write a better secret here'
      nonce_key: 'write a better secret here'
      auth_salt: 'write a better secret here'
      secure_auth_salt: 'write a better secret here'
      logged_in_salt: 'write a better secret here'
      nonce_salt: 'write a better secret here'

                        </code></pre>
                    </section>
                    <section>
                        <h2 class="mini">Ejemplo con Deployer</h2>

                        <p>Y ahora, desplegar es tan simple como ejecutar:</p>

                        <pre><code class="hljs" data-trim contenteditable>
./vendor/bin/dep deploy staging
                        </code></pre>
                        <pre><code class="hljs" data-trim contenteditable>
./vendor/bin/dep deploy production
                        </code></pre>
                    </section>
                    <section>
                        <h2 class="mini">Herramientas de Integración Continua</h2>
                        <div class="fragment">
                            <img data-src="images/ci.png" >

                            <p><small>Puedes ver una comparación más detallada en <a href="http://stackshare.io/continuous-integration">Stackshare</a>.</small></p>
                        </div>
                    </section>
                    <section>
                        <h2 class="mini">Ejemplo con Snap.CI</h2>
                        <img data-src="images/snap.png" >
                        <ul>
                            <li>He elegido <a href="https://snap-ci.com/">Snap</a> porque me gusta su implementación del concepto 'Deployment Pipeline'.</li>
                            <li>Software as a Service.</li>
                            <li>Gratis para proyectos Open Source.</li>
                            <li><a href="https://jenkins.io/">Jenkins</a> (free) o <a href="https://www.jetbrains.com/teamcity/">TeamCity</a> (freemium) opciones para self-hosted.</li>
                        </ul>
                    </section>
                    <section>
                        <h2 class="mini">Ejemplo con Snap.CI</h2>
                        <p>
                            <img data-src="images/snapci1.png" >
                        </p>
                        <p>
                            <small><a href="https://snap-ci.com/artberri/sinrumbofijo/branch/master">https://snap-ci.com/artberri/sinrumbofijo/branch/master</a></small>
                        </p>
                    </section>
                    <section>
                        <h2 class="mini">Ejemplo con Snap.CI</h2>
                        <p>
                            <img data-src="images/deps-snap.png" >
                        </p>
                    </section>
                    <section>
                        <h2 class="mini">Ejemplo con Snap.CI</h2>
                        <p>
                            <img data-src="images/staging-snap.png" >
                        </p>
                    </section>
                    <section>
                        <h2 class="mini">Ejemplo con Snap.CI</h2>
                        <p>
                            <img data-src="images/prod-snap.png" >
                        </p>
                    </section>

                    <section data-background="images/minions6.jpg">
                        <h1>Entonces...<br> Te atreves<br> a desplegar<br> ahora <br>mismo?</h1>
                    </section>

                </section>

                <section>
                    <section>
                        <h2>El 'máximo'</h2>
                        <h3>El testeo debe estar totalmente automatizado</h3>
                    </section>
                    <section>
                        <h2>Antes de subir código</h2>
                    </section>
                    <section>
                        <h2 class="mini">Linting</h2>

                        <p>Todo el equipo debe usar las mismas 'coding conventions' y comprobar que se siguen con <a href="https://github.com/squizlabs/PHP_CodeSniffer">PHP_CodeSniffer</a>, también te ayuda a evitar errores.</p>

                        <div class="fragment">
                            <p>Instalar <a href="https://github.com/squizlabs/PHP_CodeSniffer">PHP_CodeSniffer</a> con <em>composer</em>:</p>

                            <pre><code class="hljs" data-trim contenteditable>
composer require --dev squizlabs/php_codesniffer
composer require --dev wp-coding-standards/wpcs:dev-master
                            </code></pre>


                            <pre><code class="hljs" data-trim contenteditable>
# composer.json
# ...
    "require-dev": {
        "squizlabs/php_codesniffer": "^2.6",
        "wp-coding-standards/wpcs": "dev-master",
    },
# ...
                            </code></pre>
                        </div>
                    </section>
                    <section>
                        <h2 class="mini">Linting</h2>

                        <p>Configurar las reglas en el fichero <em>phpcs.xml</em>.</p>

                        <div class="">

                            <pre><code class="hljs" data-trim contenteditable>
&lt;!-- phpcs.xml --&gt;

&lt;?xml version="1.0"?&gt;
&lt;ruleset name="PHP_CodeSniffer"&gt;
  &lt;description&gt;The coding standard for PHP_CodeSniffer itself.&lt;/description&gt;

  &lt;file&gt;src/wp-content/themes/your-theme&lt;/file&gt;
  &lt;file&gt;src/wp-content/plugins/your-plugin1&lt;/file&gt;
  &lt;file&gt;src/wp-content/plugins/your-plugin2&lt;/file&gt;

  &lt;arg name="report" value="summary"/&gt;
  &lt;arg value="np"/&gt;

  &lt;rule ref="PEAR.WhiteSpace.ScopeIndent"&gt;
    &lt;properties&gt;
      &lt;property name="indent" value="2"/&gt;
    &lt;/properties&gt;
  &lt;/rule&gt;

  &lt;rule ref="vendor/wp-coding-standards/wpcs"/&gt;
&lt;/ruleset&gt;
                            </code></pre>

                        </div>
                    </section>
                    <section>
                        <h2 class="mini">Linting</h2>

                        <p>Y añadir el paso al 'task runner' (Deployer).</p>

                        <div class="">
                            <pre><code class="hljs" data-trim contenteditable>
&lt;?php
// deploy.php

require 'recipes/qa.php';

                            </code></pre>
                            <pre><code class="hljs" data-trim contenteditable>
&lt;?php
// recipes/qa.php

task('qa:phpcs', function () {
  $output = runLocally('./vendor/bin/phpcs');
  writeln('<info>' . $output . '</info>');
})->desc('Run PHPCS');

task('qa', [
  'qa:phpcs',
])->desc('Code quality checks');

                            </code></pre>

                        </div>
                    </section>
                    <section>
                        <h2 class="mini">Linting</h2>
                        <p>Otras herramientas:</p>
                        <ul>
                            <li>PHP: <a href="https://phpmd.org/">PHPMD</a> (Mess Detector), <a href="https://github.com/sebastianbergmann/phpdcd">PHPDCD</a> (Dead Code Detector), <a href="https://github.com/sebastianbergmann/phpcpd">PHPCPD</a> (Copy/Paste Detector),...</li>
                            <li>Javascript: <a href="http://eslint.org/">Eslint</a>, <a href="http://jshint.com/">JSHint</a>, <a href="http://www.jslint.com/">JSLint</a>,...</li>
                            <li>CSS: <a href="https://github.com/CSSLint/csslint">CSSLint</a>, <a href="https://github.com/brigade/scss-lint">SASS Lint</a>,...</li>
                        </ul>
                    </section>
                    <section>
                        <h2 class="mini">Unit Testing</h2>
                        <blockquote>Do the things right</blockquote>
                        <p>Sí, puedes (debes) hacer unit test con tus themes y plugins.</p>
                        <p class="fragment">Usa <a href="https://phpunit.de/">PHPUnit</a> y <a href="https://github.com/10up/wp_mock">WP_Mock</a>.</p>
                        <p class="fragment"><small>WP_Mock está desarrollado por '10up' donde trabaja Lucy Tomas (ponencia después de comer).</small></p>
                    </section>
                    <section>
                        <h2 class="mini">Unit Testing</h2>

                        <div class="">
                            <p>Instalar con <em>composer</em>:</p>

                            <pre><code class="hljs" data-trim contenteditable>
composer require --dev phpunit/phpunit
composer require --dev 10up/wp_mock:dev-master
                            </code></pre>


                            <pre><code class="hljs" data-trim contenteditable>
# composer.json
# ...
    "require-dev": {
        "phpunit/phpunit": "^4.8",
        "10up/wp_mock": "dev-master",
    },
# ...
                            </code></pre>
                        </div>
                    </section>
                    <section>
                        <h2 class="mini">Unit Testing</h2>

                        <p>Configurar en el fichero <em>phpunit.xml</em>.</p>

                        <div class="">

                            <pre><code class="hljs" data-trim contenteditable>
&lt;!-- phpunit.xml --&gt;

&lt;phpunit bootstrap="tests/bootstrap.php"&gt;

  &lt;testsuites&gt;
    &lt;testsuite name="projectname"&gt;
      &lt;directory&gt;tests&lt;/directory&gt;
    &lt;/testsuite&gt;
  &lt;/testsuites&gt;

  &lt;filter&gt;
    &lt;whitelist processUncoveredFilesFromWhitelist="true"&gt;
      &lt;directory suffix=".php"&gt;src/wp-content/themes/your-theme&lt;/directory&gt;
    &lt;/whitelist&gt;
  &lt;/filter&gt;

  &lt;logging&gt;
    &lt;log type="coverage-html" target="reports/html/phpunit/coverage" lowUpperBound="35"
        highLowerBound="70"/&gt;
    &lt;log type="coverage-text" target="php://stdout" showUncoveredFiles="false"/&gt;
    &lt;log type="junit" target="reports/phpunit.results.xml" logIncompleteSkipped="false"/&gt;
  &lt;/logging&gt;

&lt;/phpunit&gt;
                            </code></pre>

                        </div>
                    </section>
                    <section>
                        <h2 class="mini">Unit Testing</h2>

                        <p>Y añadir el paso al 'task runner' (Deployer)..</p>

                        <div class="">

                            <pre><code class="hljs" data-trim contenteditable>
&lt;?php
// recipes/qa.php

task('qa:phpunit', function () {
  $output = runLocally('./vendor/bin/phpunit');
  writeln('<info>' . $output . '</info>');
})->desc('Run PHPUnit');
task('qa:phpcs', function () {
  $output = runLocally('./vendor/bin/phpcs');
  writeln('<info>' . $output . '</info>');
})->desc('Run PHPCS');
task('qa', [
  'qa:phpcs',
  'qa:phpunit',
])->desc('Code quality checks');

                            </code></pre>
                            <p>Ejecutar:</p>
                            <pre><code class="hljs" data-trim contenteditable>
./vendor/bin/dep qa
                            </code></pre>


                        </div>
                    </section>
                    <section>
                        <h2 class="mini">Añadir al 'deployment pipeline'</h2>
                        <p>
                            <img data-src="images/snapci2.png" >
                        </p>
                    </section>
                    <section>
                        <h2>Después del despliegue</h2>
                    </section>
                    <section>
                        <h2 class="mini">Test funcionales</h2>
                        <blockquote>Do the right things</blockquote>
                        <p>Sí, puedes (debes) hacer test funcionales a tu web WordPress.</p>
                        <p class="fragment">Usa <a href="http://docs.behat.org/">Behat</a>, <a href="http://mink.behat.org/">Mink</a>, <a href="https://github.com/FriendsOfPHP/Goutte">Goutte</a> y <a href="http://www.seleniumhq.org/    ">Selenium</a>.</p>
                    </section>
                    <section>
                        <h2 class="mini">Test funcionales</h2>

                        <div class="">
                            <p>Instalar con <em>composer</em>:</p>

                            <pre><code class="hljs" data-trim contenteditable>
composer require --dev behat/behat
composer require --dev behat/mink-extension
composer require --dev behat/mink-goutte-driver
composer require --dev behat/mink-selenium2-driver
composer require --dev se/selenium-server-standalone
                            </code></pre>


                            <pre><code class="hljs" data-trim contenteditable>
# composer.json
# ...
    "require-dev": {
        "behat/behat": "~3.0.6",
        "behat/mink-extension": "^2.2",
        "behat/mink-goutte-driver": "^1.2",
        "behat/mink-selenium2-driver": "^1.3",
        "se/selenium-server-standalone": "^2.53"
    },
# ...
                            </code></pre>
                        </div>
                    </section>
                    <section>
                        <h2 class="mini">Test funcionales</h2>

                        <p>Configurar Behat en el fichero <em>behat.yml</em>:</p>

                        <div class="">

                            <pre><code class="hljs" data-trim contenteditable>
# behat.yml
default:
  extensions:
    Behat\MinkExtension:
      base_url: 'http://yoursite.local'
      browser_name: 'firefox'
      sessions:
        default:
          goutte: ~
        browser:
          selenium2: ~
      javascript_session: 'browser'
    emuse\BehatHTMLFormatter\BehatHTMLFormatterExtension:
      name: html
      renderer: Twig,Behat2
      file_name: index
      print_args: true
      print_outp: true
      loop_break: true
  formatters:
    pretty: true
    html:
      output_path: %paths.base%/reports/html/behat
staging:
  extensions:
    Behat\MinkExtension:
      base_url: 'http://staging.yoursite.com'
production:
  extensions:
    Behat\MinkExtension:
      base_url: 'http://www.yoursite.com'
                            </code></pre>

                        </div>
                    </section>
                    <section>
                        <h2 class="mini">Test funcionales</h2>

                        <p>Definir algunos test (e implementarlos, claro)</p>

                        <div class="">

                            <pre><code class="hljs" data-trim contenteditable>
@mink:browser
Feature: Article
    In order to interact with the author
    As a user
    I need to be able to read and comment articles or navigate to related info

    Background:
        Given I am on the homepage
        And I hover over the element ".smartlib-grid-list article.post .wp-post-image"
        And I click on ".smartlib-grid-list article.post .smartlib-caption-link"

    @smoke
    Scenario: See sections
        Then I should see "Deja un comentario"
        And I should see "Entradas relacionadas"
        And I should see "Entradas recientes"

    Scenario: Make a comment
        When I fill in the following:
        | author | Testuser |
        | email | test@example.com |
        | url | http://example.com |
        And I fill in "comment" with 15 random words
        And I press "Publicar comentario"
        Then I should see "Testuser"
                            </code></pre>

                        </div>
                    </section>
                    <section>
                        <h2 class="mini">Test funcionales</h2>

                        <p>Y añadir el paso al 'task runner' (Deployer).</p>

                        <div class="">

                            <pre><code class="hljs" data-trim contenteditable>
&lt;?php
// recipes/at.php

task('at', function () {
  $stage = env('app.stage');
  $testCommand = './vendor/bin/behat';
  if ('dev' != $stage) {
    $testCommand .= ' --profile=' . $stage;
  }

  $seleniumPid = runLocally('nohup ./vendor/bin/selenium-server-standalone > /dev/null 2> /dev/null & echo $!');
  writeln('<info>Selenium running with pid: ' . $seleniumPid . '</info>');

  writeln('<info>Waiting until selenium is started</info>');
  $output = runLocally('sleep 7');
  writeln('<info>Selenium started</info>');

  $output = runLocally($testCommand, 600);
  writeln('<info>' . $output . '</info>');

  $output = runLocally('kill ' . $seleniumPid);
  writeln('<info>Selenium stopped</info>');
})->desc('Run Acceptance Tests');

                            </code></pre>
                            <p>Ejecutar:</p>
                            <pre><code class="hljs" data-trim contenteditable>
./vendor/bin/dep at staging
                            </code></pre>


                        </div>
                    </section>
                    <section>
                        <h2 class="mini">Añadirlo al 'deployment pipeline'</h2>
                        <p>
                            <img data-src="images/snap-acceptance.png" >
                        </p>
                    </section>
                    <section>
                        <h2 class="mini">Añadirlo al 'deployment pipeline'</h2>
                        <p>
                            <img data-src="images/snap-smoke.png" >
                        </p>
                    </section>
                </section>

                <section data-transition="fade-in">
                    <h3 class="mini">Finalmente, hemos implementado...</h3>

                    <h2 class="mini fragment">Continous Delivery</h2>
                </section>

                <section data-transition-speed="fast" data-transition="fade-in ">
                    <h3 class="mini">Finalmente, hemos implementado...</h3>

                    <h2 class="mini ">Continous Deployment</h2>
                </section>

                <section>
                    <h2 class="mini">Continous Delivery <br><span>VS</span><br> Continous deployment</h2>
                    <img data-src="images/continuous-delivery-deployment-sm.jpg" >

                    <p><small>Mira <a href="https://puppet.com/blog/continuous-delivery-vs-continuous-deployment-what-s-diff">este post</a> para más info.</small></p>
                </section>

                <section data-background="images/minions7.jpg">
                    <h1>Sí,<br> recuerdo <br> el despliegue.<br>Veamos<br> si fue bien!</h1>
                </section>

                <section data-background="images/everythinkok.gif">

                </section>

                <section>
                    <div>
                        <h2 class="mini">Links del ejemplo completo</h2>
                        <ul>
                            <li><a href="https://github.com/artberri/sinrumbofijo">https://github.com/artberri/sinrumbofijo</a></li>
                            <li><a href="https://snap-ci.com/artberri/sinrumbofijo/branch/master">https://snap-ci.com/artberri/sinrumbofijo/branch/master</a></li>
                        </ul>
                    </div><br>
                    <div class="fragment">
                        <h2 class="mini">Good job!</h2>
                        <img src="images/wordpress-bilbao.jpg">
                    </div>
                </section>

                <section>
                    <h2 class="mini">Gracias</h2>
                    <div>
                        <img  data-src="images/thanks.gif" alt="Thank you" >
                    </div>
                    <p>Preguntas</p>
                    <p><small><a href="https://www.berriart.com/talks/wordpress-deployment-es/">https://www.berriart.com/talks/wordpress-deployment-es/</a></small></p>
                </section>
            </div>

        </div>

		<script src="../dist/reveal.js"></script>
        <script src="../plugin/markdown/markdown.js"></script>
        <script src="../plugin/highlight/highlight.js"></script>
        <script src="../plugin/notes/notes.js"></script>
		<script src="../plugin/zoom/zoom.js"></script>

        <script>

            // More info https://github.com/hakimel/reveal.js#configuration
            Reveal.initialize({
                controls: true,
                progress: true,
                history: true,
                center: true,

                transition: 'slide', // none/fade/slide/convex/concave/zoom

                plugins: [ RevealMarkdown, RevealHighlight, RevealNotes, RevealZoom ]
            });

        </script>

    </body>
</html>
