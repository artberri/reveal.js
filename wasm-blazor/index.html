<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">

    <title>WebAssembly &amp; Blazor</title>

    <meta name="description" content="WebAssembly & Blazor">
    <meta name="author" content="Alberto Varela">

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">


    <link href='https://fonts.googleapis.com/css?family=Abel|Inconsolata' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="../css/reveal.min.css">
    <link rel="stylesheet" href="../css/theme/black.css" id="theme">

    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="../lib/css/zenburn.css">
    <link rel="stylesheet" href="style.css">

    <!-- Printing and PDF exports -->
    <script>
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = window.location.search.match( /print-pdf/gi ) ? '../css/print/pdf.css' : '../css/print/paper.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
    </script>

    <!--[if lt IE 9]>
        <script src="lib/js/html5shiv.js"></script>
        <![endif]-->
</head>

<body>

    <div class="reveal">

        <!-- Any section element inside of this container is displayed as a slide -->
        <div class="slides">
            <section id="home" data-background="images/25bb0f734d0dfcab4dccabd671decba7.gif" data-background-color="#000000" data-state="">
                <div id="home-inner">
                    <h1>WebAssembly &amp; Blazor</nobr>
                    </h1>
                    <h2>A Glimpse to our Possible Future</h2>
                    <p id="byauthor">
                        By
                        <a href="http://www.berriart.com/">Alberto Varela</a>
                        <br>
                        <small>Background images:
                                <a href="https://www.deviantart.com/kirokaze/">kirokaze</a></small>
                    </p>
                </div>
            </section>

            <section>
                <h2 class="mini">Who am I</h2>
                <div class=" fragment">
                    <p>I'm
                        <a href="http://www.berriart.com">Alberto Varela</a> and I work
                        <br>as developer at  </p>
                    <p>
                        <a href="http://www.plainconcepts.com">
                            <img class="noborder" width="240" src="./images/plainconcepts.png" />
                        </a>
                    </p>
                    <p class=" fragment">
                        <small style="color:#666;">
                            <a style="color:#666;" href="https://github.com/artberri">github.com/artberri</a> |
                            <a style="color:#666;" href="https://twiter.com/artberri">twiter.com/artberri</a> |
                            <a style="color:#666;" href="https://www.berriart.com">berriart.com</a> |
                            <a style="color:#666;" href="mailto:alberto@berriart.com">alberto@berriart.com</a>
                        </small>
                    </p>
                </div>
            </section>

            <section>
                <h2>Agenda</h2>
                <ul>
                    <li>Why WebAssembly?</li>
                    <li>What is Blazor?</li>
                    <li>Blazor basics</li>
                    <li>Demo</li>
                </ul>
            </section>

            <section data-background="images/shooting_stars2_by_kirokaze-d9ikcm1.gif" data-background-color="#000000" data-state="dimbg">
                <h1>Why WebAssembly?</h1>
            </section>

            <section>
                <h3>State of the Art</h3>
                <div>
                    <img src="images/javascript-javascript-everywhere.jpg">
                </div>
                <p class="fragment">The web has proven to be a universal platform</p>
                <aside class="notes">Todo JS SPAs, ya casi no desktop features needed, buen tooling,...</aside>
            </section>

            <section>
                <blockquote>The Web began as a simple document exchange network but
                        <strong>has now become the most ubiquitous application platform
                        ever</strong>, accessible across a vast array of operating systems and
                        device types. <strong>By historical accident, JavaScript is the only
                        natively supported programming language on the Web</strong>, its
                        widespread usage unmatched by other technologies available
                        only via plugins like...</blockquote>
                <p><small>
                    Source: <a href="https://github.com/WebAssembly/spec/blob/master/papers/pldi2017.pdf">Bringing the Web up to Speed with WebAssembly</a>
                    <br>
                    <a href="https://github.com/WebAssembly/spec/blob/master/papers/pldi2017.pdf">(https://github.com/WebAssembly/spec/blob/master/papers/pldi2017.pdf)</a>
                </small></p>
            </section>

            <section>
                <h2>Main limitation</h2>
                <p>JavaScript can’t run the program as fast as the operating system can run a comparable native program written in other programming languages.</p>
                <pre class="fragment">
                    <code class="hljs" data-trim>
                        "5" - 3 = 2
                        "5" + 3 = "53"
                    </code>
                </pre>
                <p><small>
                    Source: <a href="https://medium.com/mozilla-tech/why-webassembly-is-a-game-changer-for-the-web-and-a-source-of-pride-for-mozilla-and-firefox-dda80e4c43cb">Why WebAssembly is a game changer for the web  —  and a source of pride for Mozilla and Firefox</a>
                </small></p>
            </section>

            <section>
                <h2>The proof of concept</h2>
                <h3><a href="http://asmjs.org/">asm.js</a></h3>
                <p>An extraordinarily optimizable, low-level subset of JavaScript</p>
            </section>

            <section>
                <a href="https://webassembly.org/"><img class="noborder" src="images/webassembly.jpg"></a>
                <p><small>Image source: <a href="https://www.redbubble.com/people/slumber86/works/25388719-webassembly-logo-and-text">slumber86 (RedBubble)</a></small></p>
            </section>

            <section>
                <h2 class="mini">What is WebAssembly (WASM)</h2>
                <ul>
                    <li>An improvement to JavaScript</li>
                    <li>A new language</li>
                    <li>A browser improvement</li>
                    <li>A Compile Target</li>
                </ul>
                <br><br>
                <p><small>
                    Source: <a href="https://medium.com/javascript-scene/what-is-webassembly-the-dawn-of-a-new-era-61256ec5a8f6">What is WebAssembly? - The Dawn of a New Era</a>
                </small></p>
                <aside class="notes">
                    <ul>
                        <li>An improvement to JavaScript: Implement your performance critical stuff in wasm and import it like a standard JavaScript module.</li>
                        <li>A new language: WebAssembly code defines an AST (Abstract Syntax Tree) represented in a binary format. You can author and debug in a text format so it’s readable.</li>
                        <li>A browser improvement: Browsers will understand the binary format, which means we’ll be able to compile binary bundles that compress smaller than the text JavaScript we use today. Smaller payloads mean faster delivery. Depending on compile-time optimization opportunities, WebAssembly bundles may run faster than JavaScript, too!</li>
                        <li>A Compile Target: A way for other languages to get first-class binary support across the entire web platform stack.</li>
                    </ul>
                </aside>
            </section>

            <section>
                <h2 class="mini">Browser Support?</h2>
                <div class="fragment">
                    <img src="images/support.png" alt="Browser Support">
                    <p><small>Source: <a href="https://caniuse.com/#search=wasm">Can I Use</a></small></p>
                </div>
            </section>

            <section>
                <h2 class="mini">Compilers?</h2>
                <ul class="fragment mini">
                    <li><a href="https://github.com/kripken/emscripten">Emscripten</a> is an LLVM-to-JavaScript compiler</li>
                    <li><a href="https://www.leaningtech.com/cheerp/">Cheerp</a> is a C++ compiler for the Web</li>
                    <li><a href="https://github.com/WebAssembly/binaryen">Binaryen</a> is a compiler and toolchain infrastructure library for WebAssembly</li>
                    <li><a href="https://github.com/AssemblyScript/assemblyscript">AssemblyScript</a> compiles strictly typed TypeScript to WebAssembly using Binaryen</li>
                    <li><a href="http://teavm.org/">TeaVM</a>  is an ahead-of-time compile of Java bytecode to JavaScript and WebAssembly</li>
                    <li><a href="https://www.rust-lang.org/">Rust</a> is a systems programming language that can compile to WebAssembly</li>
                    <li>...</li>
                </ul>
            </section>

            <section data-background="images/factory_5_by_kirokaze-d9dnodi.gif" data-background-color="#000000" data-state="dimbg">
                <h1>What is Blazor?</h1>
            </section>

            <section>
                <p>Blazor is an <strong>EXPERIMENTAL</strong> .NET web framework using C#/Razor and HTML that runs in the browser with WebAssembly</p>
            </section>

            <section data-background-image="images/experiment.webp">
                <div>
                    <h1 class="blinkme">Warning!!</h1>
                </div>
            </section>

            <section>
                <h2 class="mini">Features of Blazor</h2>
                <ul class="mini">
                    <li class="fragment">Builds SPAs</li>
                    <li class="fragment">Runs on top of Mono
                        <ul>
                            <li><a href="https://github.com/aspnet/Blazor/issues/835#issuecomment-389044165">Probably will run on .NET Core in the future</a></li>
                        </ul>
                    </li>
                    <li class="fragment">Is programmed with C# and Razor syntax</li>
                    <li class="fragment">Uses component-based architecture</li>
                    <li class="fragment">Is open-source &amp; free</li>
                </ul>
            </section>

            <section>
                <h2 class="mini">Weird features of Blazor</h2>
                <ul class="mini">
                    <li class="fragment">Share code across server and client</li>
                    <li class="fragment">Invoke Javascript functions from C#</li>
                    <li class="fragment">Invoke C# methods from Javascript </li>
                </ul>
                <div class="fragment">
                    <img src="images/giphy.webp">
                </div>
            </section>

            <section>
                <h3 class="mini">How it works?</h3>
                <div style="display: flex;width: 100%;">
                    <div style="flex: 1">
                        <h4>Interpreted<br><small>Present</small> </h4>
                        <img style="max-width: 350px;" src="images/interpreted-mode.png">
                    </div>
                    <div style="flex: 1">
                        <h4>Ahead-of-time (AOT)<br><small>Future?</small> </h4>
                        <img style="max-width: 350px;" src="images/aot-mode.png">
                    </div>
                </div>

                <p><small>
                    Source: <a href="http://blog.stevensanderson.com/2018/02/06/blazor-intro/">Blazor: a technical introduction</a> (Steve Sanderson)
                </small></p>
            </section>

            <section data-background="images/redlights_by_kirokaze-daiefoq.gif" data-background-color="#000000" data-state="dimbg">
                <h1>Blazor Basics</h1>
            </section>

            <section>
                <h3>Based on components</h3>
                <div style="display: flex;width: 100%;">
                    <div style="width: 48%;">
                        <p><small>ParentComponent.cshtml</small></p>
                        <pre><code class="hljs" data-trim>
                            @page "/ParentComponent"

                            <h1>Parent-child example</h1>

                            <ChildComponent Title="Panel Title from Parent">
                                Child content of the child component is supplied by the parent component.
                            </ChildComponent>
                        </code></pre>
                    </div>
                    <div>&nbsp;</div>
                    <div style="width: 48%;">
                        <p><small>ChildComponent.cshtml</small></p>
                        <pre><code class="hljs" data-trim>
                            <div class="panel panel-success">
                                <div class="panel-heading">@Title</div>
                                <div class="panel-body">@ChildContent</div>
                            </div>

                            @functions {
                                [Parameter]
                                private string Title { get; set; }

                                [Parameter]
                                private RenderFragment ChildContent { get; set; }
                            }
                        </code></pre>
                    </div>
                </div>
            </section>

            <section>
                <h3>Component Lifecycle</h3>
                <div style="display: flex;width: 100%;">
                    <div style="width: 48%;">
                        <p><small>Sync methods</small></p>
                        <pre><code class="hljs" data-trim>
                            @using System
                            @implements IDisposable

                            ...

                            @functions {
                                protected override void OnInit()
                                {
                                    ...
                                }
                                protected override void OnParametersSet()
                                {
                                    ...
                                }
                                protected override void OnAfterRender()
                                {
                                    ...
                                }
                                public void Dispose()
                                {
                                    ...
                                }
                            }
                        </code></pre>
                    </div>
                    <div>&nbsp;</div>
                    <div style="width: 48%;">
                        <p><small>Async methods</small></p>
                        <pre><code class="hljs" data-trim>
                            ...

                            @functions {
                                protected override async Task OnInitAsync()
                                {
                                    await ...
                                }

                                protected override async Task OnParametersSetAsync()
                                {
                                    await ...
                                }
                                protected override async Task OnAfterRenderAsync()
                                {
                                    await ...
                                }
                            }
                        </code></pre>
                    </div>
                </div>
            </section>

            <section>
                <h3>Layouts</h3>
                <p>Layouts are just Blazor components</p>
                <div style="display: flex;width: 100%;">
                    <div style="width: 48%;">
                        <p><small>MainLayout.cshtml</small></p>
                        <pre><code class="hljs" data-trim>
                            @inherits BlazorLayoutComponent
                            &lt;html&gt;
                                <head>...</head>
                                <body>
                                    <header>...</header>
                                    <nav>...</nav>
                                    @Body

                                    <footer>
                                        &copy; by @CopyrightMessage
                                    </footer>
                                </body>
                            &lt;/html&gt;

                            @functions {
                                public string CopyrightMessage { get; set; }
                                ...
                            }
                        </code></pre>
                    </div>
                    <div>&nbsp;</div>
                    <div style="width: 48%;">
                        <p><small>WhateverPageComponent.cshtml</small></p>
                        <pre><code class="hljs" data-trim>
                            @layout MainLayout

                            @page "/whatever"

                            <h1>Whatever</h1>
                            ...
                        </code></pre>
                    </div>
                </div>
            </section>

            <section>
                <h3>Built-in Dependency Injection</h3>
                <div style="display: flex;width: 100%;">
                    <div style="width: 48%;">
                        <p><small>Startup.cs</small></p>
                        <pre><code class="hljs" data-trim>
                            public void ConfigureServices(IServiceCollection services)
                            {
                                services.AddSingleton&lt;IDataAccess, DataAccess&gt;();
                                services.AddTransient&lt;IOrder, Order&gt;();
                                services.AddScoped&lt;Whatever&gt;(); // Behavies as singlteon, don't use it
                            }
                        </code></pre>
                    </div>
                    <div>&nbsp;</div>
                    <div style="width: 48%;">
                        <p><small>WhateverPageComponent.cshtml</small></p>
                        <pre><code class="hljs" data-trim>
                            @layout MainLayout
                            @using App.Domain.Entites
                            @page "/customers"
                            @inject IDataAccess DataRepository

                            <h1>Customers</h1>
                            <ul>
                                @if (Customers != null)
                                {
                                    @foreach (var customer in Customers)
                                    {
                                        <li>@customer.FirstName @customer.LastName</li>
                                    }
                                }
                            </ul>

                            @functions {
                                private IReadOnlyList&lt;Customer&gt; Customers;

                                protected override async Task OnInitAsync()
                                {
                                    Customers = await DataRepository.GetAllCustomersAsync();
                                }
                            }
                        </code></pre>
                    </div>
                </div>
            </section>

            <section>
                <h3>Built-in Router</h3>
                <div style="display: flex;width: 100%;">
                    <div style="width: 48%;">
                        <p><small>App.cshtml</small></p>
                        <pre><code class="hljs" data-trim>
                        ...

                        &lt;Router AppAssembly=typeof(Program).Assembly &gt;

                        ...
                        </code></pre>
                        <br>
                        <p><small>WhateverPageComponent.cshtml</small></p>
                        <pre><code class="hljs" data-trim>
                        @page "/BlazorRoute"
                        @page "/BlazorRoute/{text}"

                        <h1>Blazor is @Text!</h1>

                        @functions {
                            [Parameter]
                            private string Text { get; set; } = "fantastic";
                        }
                        </code></pre>
                    </div>
                    <div>&nbsp;</div>
                    <div style="width: 48%;">
                        <p><small>Shared/NavMenu.cshtml</small></p>
                        <pre><code class="hljs" data-trim>
                            <div class="navbar-collapse collapse">
                                <ul class="nav navbar-nav">
                                    <li>
                                        <NavLink href="" Match=NavLinkMatch.All>
                                            <span class="glyphicon glyphicon-home"></span> Home
                                        </NavLink>
                                    </li>
                                    <li>
                                        <NavLink href="BlazorRoute">
                                            <span class="glyphicon glyphicon-th-list"></span> Blazor Route
                                        </NavLink>
                                    </li>
                                </ul>
                            </div>
                        </code></pre>
                    </div>
                </div>
            </section>

            <section>
                <h3>Magic (Interop)</h3>
                <p>Invoke JavaScript from .NET</p>
                <div style="display: flex;width: 100%;">
                    <div style="width: 48%;">
                        <p><small>app.js:</small></p>
                        <pre><code class="hljs" data-trim>
                        window.formJsFunctions = {
                            showPrompt: function (message) {
                                return prompt(message, 'Type anything here');
                            }
                        };
                        </code></pre>
                        <p><small>FormJsInterop.cs</small></p>
                        <pre><code class="hljs" data-trim>
                            public class FormJsInterop
                            {
                                public static Task&lt;string&gt; Prompt(string message)
                                {
                                    return JSRuntime.Current.InvokeAsync&lt;string&gt;(
                                        "formJsFunctions.showPrompt",
                                        message);
                                }
                            }
                        </code></pre>
                    </div>
                    <div>&nbsp;</div>
                    <div style="width: 48%;">
                        <p><small>form.cshtml</small></p>
                        <pre><code class="hljs" data-trim>
                            @using MyLib

                            <input ref="username" />
                            <button onclick="@SetFocus">Set focus</button>
                            <button onclick="@Prompt">Prompt</button>

                            @functions {
                                ElementRef username;

                                void SetFocus()
                                {
                                    username.Focus();
                                }
                                void Prompt()
                                {
                                    FormJsInterop.Prompt("Whatever");
                                }
                            }
                        </code></pre>
                    </div>
                </div>
            </section>

            <section>
                <h3>Magic (Interop)</h3>
                <p>Invoke .NET from JavaScript</p>
                <div style="display: flex;width: 100%;">
                    <div style="width: 48%;">
                        <p><small>GuidHelper.cs</small></p>
                        <pre><code class="hljs" data-trim>
                            using System;
                            public class GuidHelper
                            {
                                [JSInvokable]
                                public static string GenerateGuid()
                                {
                                    return Guid.NewGuid();
                                }
                            }
                        </code></pre>
                    </div>
                    <div>&nbsp;</div>
                    <div style="width: 48%;">
                        <p><small>app.js</small></p>
                        <pre><code class="hljs" data-trim>
                            DotNet.invokeMethodAsync(assemblyName, 'GenerateGuid')
                                .then(guid => console.log(guid))
                        </code></pre>
                    </div>
                </div>
            </section>

            <section>
                <h3>Built-in Services</h3>
                <div style="display: flex;width: 100%;">
                    <div style="width: 48%;">
                        <p><small>HttpClient</small></p>
                        <pre><code class="hljs" data-trim>
                            @page "/"
                            @inject HttpClient Http

                            <button onclick="@(async () =&gt; await PrintWebApiResponse())">Print Web API Response</button>

                            @functions {
                                private async Task PrintWebApiResponse()
                                {
                                    var response = await Http.GetStringAsync("/api/Customer");
                                    Console.WriteLine(response);
                                }
                            }
                        </code></pre>
                    </div>
                    <div>&nbsp;</div>
                    <div style="width: 48%;">
                        <p><small>IUriHelper</small></p>
                        <pre><code class="hljs" data-trim>
                            @page "/hello-world"
                            @implements IDisposable
                            @inject Microsoft.AspNetCore.Blazor.Services.IUriHelper UriHelper

                            <h1>This is the query string: @Query</h1>

                            @functions {
                                private string Query { get; set; }

                                protected override void OnInit()
                                {
                                    RefreshQuery();
                                    UriHelper.OnLocationChanged += OnLocationChanges;
                                }

                                private void OnLocationChanges(object sender, string location) => RefreshQuery();

                                private void RefreshQuery()
                                {
                                    var uri = new Uri(UriHelper.GetAbsoluteUri());
                                    Query = uri;
                                    StateHasChanged();
                                }

                                public void Dispose()
                                {
                                    UriHelper.OnLocationChanged -= OnLocationChanges;
                                }
                            }
                        </code></pre>
                    </div>
                </div>
            </section>

            <section>
                <h2>Summary</h2>
                <p>Blazor is a framework for building SPAs using C#/Razor with built-in router and dependency injection systems.</p>
            </section>

            <section data-background="images/coffee_in_rain_by_kirokaze-d98qb8z.gif" data-background-color="#000000" data-state="dimbg">
                <h1>Demo</h1>
            </section>

            <section>
                <h2 class="mini">Better talks than this ;)</h2>
                <ul class="mini">
                    <li><a href="https://www.infoq.com/presentations/webassembly-wasm-intro">The WebAssembly Revolution Has Begun</a><br> Jay Phelps (Netflix)</li>
                    <li><a href="https://www.youtube.com/watch?v=BnYq7JapeDA">Build the future of the web with WebAssembly and more</a><br> Thomas Nattestad (Google)</li>
                    <li><a href="https://www.youtube.com/watch?v=JU-6pAxqAa4">Blazor, a new framework for browser-based .NET apps</a><br> Steven Sanderson (Microsoft)</li>
                    <li><a href="https://www.youtube.com/watch?v=M8agbR4VJIk">Blazor Meetup</a><br> Luis Ruiz Pavon y Carlos Landeras (Plain Concepts)</li>
                </ul>
            </section>

            <section>
                <h2 class="mini">Eskerrik asko!</h2>
                <div>
                    <img data-src="images/everythinkok.gif" alt="¡Gracias!">
                </div>
                <p>
                    <small>Slides:
                        <a href="https://www.berriart.com/talks/wasm-blazor/">https://www.berriart.com/talks/wasm-blazor/</a>
                    </small>
                </p>

            </section>
        </div>

    </div>

    <script src="../lib/js/head.min.js"></script>
    <script src="../js/reveal.min.js"></script>

    <script>
        // More info https://github.com/hakimel/reveal.js#configuration
        Reveal.initialize({
            controls: true,
            progress: true,
            history: true,
            center: true,
            //   showNotes: true,

            transition: 'slide', // none/fade/slide/convex/concave/zoom

            // More info https://github.com/hakimel/reveal.js#dependencies
            dependencies: [{
                    src: '../lib/js/classList.js',
                    condition: function () {
                        return !document.body.classList;
                    }
                },
                {
                    src: '../plugin/markdown/marked.js',
                    condition: function () {
                        return !!document.querySelector('[data-markdown]');
                    }
                },
                {
                    src: '../plugin/markdown/markdown.js',
                    condition: function () {
                        return !!document.querySelector('[data-markdown]');
                    }
                },
                {
                    src: '../plugin/highlight/highlight.js',
                    async: true,
                    callback: function () {
                        hljs.initHighlightingOnLoad();
                    }
                },
                {
                    src: '../plugin/zoom-js/zoom.js',
                    async: true
                },
                {
                    src: '../plugin/notes/notes.js',
                    async: true
                }
            ]
        });
    </script>

</body>

</html>
